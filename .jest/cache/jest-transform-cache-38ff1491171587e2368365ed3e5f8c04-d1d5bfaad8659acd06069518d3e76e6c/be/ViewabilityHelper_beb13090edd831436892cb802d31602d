9b18825dead05e4e9e85ff083f987488
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var invariant = require('invariant');
var ViewabilityHelper = function () {
  function ViewabilityHelper() {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      viewAreaCoveragePercentThreshold: 0
    };
    (0, _classCallCheck2.default)(this, ViewabilityHelper);
    this._hasInteracted = false;
    this._timers = new Set();
    this._viewableIndices = [];
    this._viewableItems = new Map();
    this._config = config;
  }
  (0, _createClass2.default)(ViewabilityHelper, [{
    key: "dispose",
    value: function dispose() {
      this._timers.forEach(clearTimeout);
    }
  }, {
    key: "computeViewableItems",
    value: function computeViewableItems(itemCount, scrollOffset, viewportHeight, getFrameMetrics, renderRange) {
      var _this$_config = this._config,
        itemVisiblePercentThreshold = _this$_config.itemVisiblePercentThreshold,
        viewAreaCoveragePercentThreshold = _this$_config.viewAreaCoveragePercentThreshold;
      var viewAreaMode = viewAreaCoveragePercentThreshold != null;
      var viewablePercentThreshold = viewAreaMode ? viewAreaCoveragePercentThreshold : itemVisiblePercentThreshold;
      invariant(viewablePercentThreshold != null && itemVisiblePercentThreshold != null !== (viewAreaCoveragePercentThreshold != null), 'Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold');
      var viewableIndices = [];
      if (itemCount === 0) {
        return viewableIndices;
      }
      var firstVisible = -1;
      var _ref = renderRange || {
          first: 0,
          last: itemCount - 1
        },
        first = _ref.first,
        last = _ref.last;
      if (last >= itemCount) {
        console.warn('Invalid render range computing viewability ' + JSON.stringify({
          renderRange: renderRange,
          itemCount: itemCount
        }));
        return [];
      }
      for (var idx = first; idx <= last; idx++) {
        var metrics = getFrameMetrics(idx);
        if (!metrics) {
          continue;
        }
        var top = metrics.offset - scrollOffset;
        var bottom = top + metrics.length;
        if (top < viewportHeight && bottom > 0) {
          firstVisible = idx;
          if (_isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, metrics.length)) {
            viewableIndices.push(idx);
          }
        } else if (firstVisible >= 0) {
          break;
        }
      }
      return viewableIndices;
    }
  }, {
    key: "onUpdate",
    value: function onUpdate(itemCount, scrollOffset, viewportHeight, getFrameMetrics, createViewToken, onViewableItemsChanged, renderRange) {
      var _this = this;
      if (this._config.waitForInteraction && !this._hasInteracted || itemCount === 0 || !getFrameMetrics(0)) {
        return;
      }
      var viewableIndices = [];
      if (itemCount) {
        viewableIndices = this.computeViewableItems(itemCount, scrollOffset, viewportHeight, getFrameMetrics, renderRange);
      }
      if (this._viewableIndices.length === viewableIndices.length && this._viewableIndices.every(function (v, ii) {
        return v === viewableIndices[ii];
      })) {
        return;
      }
      this._viewableIndices = viewableIndices;
      if (this._config.minimumViewTime) {
        var handle = setTimeout(function () {
          _this._timers.delete(handle);
          _this._onUpdateSync(viewableIndices, onViewableItemsChanged, createViewToken);
        }, this._config.minimumViewTime);
        this._timers.add(handle);
      } else {
        this._onUpdateSync(viewableIndices, onViewableItemsChanged, createViewToken);
      }
    }
  }, {
    key: "resetViewableIndices",
    value: function resetViewableIndices() {
      this._viewableIndices = [];
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      this._hasInteracted = true;
    }
  }, {
    key: "_onUpdateSync",
    value: function _onUpdateSync(viewableIndicesToCheck, onViewableItemsChanged, createViewToken) {
      var _this2 = this;
      viewableIndicesToCheck = viewableIndicesToCheck.filter(function (ii) {
        return _this2._viewableIndices.includes(ii);
      });
      var prevItems = this._viewableItems;
      var nextItems = new Map(viewableIndicesToCheck.map(function (ii) {
        var viewable = createViewToken(ii, true);
        return [viewable.key, viewable];
      }));
      var changed = [];
      for (var _ref2 of nextItems) {
        var _ref3 = (0, _slicedToArray2.default)(_ref2, 2);
        var key = _ref3[0];
        var viewable = _ref3[1];
        if (!prevItems.has(key)) {
          changed.push(viewable);
        }
      }
      for (var _ref4 of prevItems) {
        var _ref5 = (0, _slicedToArray2.default)(_ref4, 2);
        var _key = _ref5[0];
        var _viewable = _ref5[1];
        if (!nextItems.has(_key)) {
          changed.push(Object.assign({}, _viewable, {
            isViewable: false
          }));
        }
      }
      if (changed.length > 0) {
        this._viewableItems = nextItems;
        onViewableItemsChanged({
          viewableItems: Array.from(nextItems.values()),
          changed: changed,
          viewabilityConfig: this._config
        });
      }
    }
  }]);
  return ViewabilityHelper;
}();
function _isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, itemLength) {
  if (_isEntirelyVisible(top, bottom, viewportHeight)) {
    return true;
  } else {
    var pixels = _getPixelsVisible(top, bottom, viewportHeight);
    var percent = 100 * (viewAreaMode ? pixels / viewportHeight : pixels / itemLength);
    return percent >= viewablePercentThreshold;
  }
}
function _getPixelsVisible(top, bottom, viewportHeight) {
  var visibleHeight = Math.min(bottom, viewportHeight) - Math.max(top, 0);
  return Math.max(0, visibleHeight);
}
function _isEntirelyVisible(top, bottom, viewportHeight) {
  return top >= 0 && bottom <= viewportHeight && bottom > top;
}
module.exports = ViewabilityHelper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpbnZhcmlhbnQiLCJyZXF1aXJlIiwiVmlld2FiaWxpdHlIZWxwZXIiLCJjb25maWciLCJ2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCIsIl9oYXNJbnRlcmFjdGVkIiwiX3RpbWVycyIsIlNldCIsIl92aWV3YWJsZUluZGljZXMiLCJfdmlld2FibGVJdGVtcyIsIk1hcCIsIl9jb25maWciLCJmb3JFYWNoIiwiY2xlYXJUaW1lb3V0IiwiaXRlbUNvdW50Iiwic2Nyb2xsT2Zmc2V0Iiwidmlld3BvcnRIZWlnaHQiLCJnZXRGcmFtZU1ldHJpY3MiLCJyZW5kZXJSYW5nZSIsIml0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZCIsInZpZXdBcmVhTW9kZSIsInZpZXdhYmxlUGVyY2VudFRocmVzaG9sZCIsInZpZXdhYmxlSW5kaWNlcyIsImZpcnN0VmlzaWJsZSIsImZpcnN0IiwibGFzdCIsImNvbnNvbGUiLCJ3YXJuIiwiSlNPTiIsInN0cmluZ2lmeSIsImlkeCIsIm1ldHJpY3MiLCJ0b3AiLCJvZmZzZXQiLCJib3R0b20iLCJsZW5ndGgiLCJfaXNWaWV3YWJsZSIsInB1c2giLCJjcmVhdGVWaWV3VG9rZW4iLCJvblZpZXdhYmxlSXRlbXNDaGFuZ2VkIiwid2FpdEZvckludGVyYWN0aW9uIiwiY29tcHV0ZVZpZXdhYmxlSXRlbXMiLCJldmVyeSIsInYiLCJpaSIsIm1pbmltdW1WaWV3VGltZSIsImhhbmRsZSIsInNldFRpbWVvdXQiLCJkZWxldGUiLCJfb25VcGRhdGVTeW5jIiwiYWRkIiwidmlld2FibGVJbmRpY2VzVG9DaGVjayIsImZpbHRlciIsImluY2x1ZGVzIiwicHJldkl0ZW1zIiwibmV4dEl0ZW1zIiwibWFwIiwidmlld2FibGUiLCJrZXkiLCJjaGFuZ2VkIiwiaGFzIiwiaXNWaWV3YWJsZSIsInZpZXdhYmxlSXRlbXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJ2aWV3YWJpbGl0eUNvbmZpZyIsIml0ZW1MZW5ndGgiLCJfaXNFbnRpcmVseVZpc2libGUiLCJwaXhlbHMiLCJfZ2V0UGl4ZWxzVmlzaWJsZSIsInBlcmNlbnQiLCJ2aXNpYmxlSGVpZ2h0IiwiTWF0aCIsIm1pbiIsIm1heCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJWaWV3YWJpbGl0eUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xuXG5leHBvcnQgdHlwZSBWaWV3VG9rZW4gPSB7XG4gIGl0ZW06IGFueSxcbiAga2V5OiBzdHJpbmcsXG4gIGluZGV4OiA/bnVtYmVyLFxuICBpc1ZpZXdhYmxlOiBib29sZWFuLFxuICBzZWN0aW9uPzogYW55LFxuICAuLi5cbn07XG5cbmV4cG9ydCB0eXBlIFZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlyID0ge1xuICB2aWV3YWJpbGl0eUNvbmZpZzogVmlld2FiaWxpdHlDb25maWcsXG4gIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IChpbmZvOiB7XG4gICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgIC4uLlxuICB9KSA9PiB2b2lkLFxuICAuLi5cbn07XG5cbmV4cG9ydCB0eXBlIFZpZXdhYmlsaXR5Q29uZmlnID0ge3xcbiAgLyoqXG4gICAqIE1pbmltdW0gYW1vdW50IG9mIHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdGhhdCBhbiBpdGVtIG11c3QgYmUgcGh5c2ljYWxseSB2aWV3YWJsZSBiZWZvcmUgdGhlXG4gICAqIHZpZXdhYmlsaXR5IGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQuIEEgaGlnaCBudW1iZXIgbWVhbnMgdGhhdCBzY3JvbGxpbmcgdGhyb3VnaCBjb250ZW50IHdpdGhvdXRcbiAgICogc3RvcHBpbmcgd2lsbCBub3QgbWFyayB0aGUgY29udGVudCBhcyB2aWV3YWJsZS5cbiAgICovXG4gIG1pbmltdW1WaWV3VGltZT86IG51bWJlcixcblxuICAvKipcbiAgICogUGVyY2VudCBvZiB2aWV3cG9ydCB0aGF0IG11c3QgYmUgY292ZXJlZCBmb3IgYSBwYXJ0aWFsbHkgb2NjbHVkZWQgaXRlbSB0byBjb3VudCBhc1xuICAgKiBcInZpZXdhYmxlXCIsIDAtMTAwLiBGdWxseSB2aXNpYmxlIGl0ZW1zIGFyZSBhbHdheXMgY29uc2lkZXJlZCB2aWV3YWJsZS4gQSB2YWx1ZSBvZiAwIG1lYW5zXG4gICAqIHRoYXQgYSBzaW5nbGUgcGl4ZWwgaW4gdGhlIHZpZXdwb3J0IG1ha2VzIHRoZSBpdGVtIHZpZXdhYmxlLCBhbmQgYSB2YWx1ZSBvZiAxMDAgbWVhbnMgdGhhdFxuICAgKiBhbiBpdGVtIG11c3QgYmUgZWl0aGVyIGVudGlyZWx5IHZpc2libGUgb3IgY292ZXIgdGhlIGVudGlyZSB2aWV3cG9ydCB0byBjb3VudCBhcyB2aWV3YWJsZS5cbiAgICovXG4gIHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkPzogbnVtYmVyLFxuXG4gIC8qKlxuICAgKiBTaW1pbGFyIHRvIGB2aWV3QXJlYVBlcmNlbnRUaHJlc2hvbGRgLCBidXQgY29uc2lkZXJzIHRoZSBwZXJjZW50IG9mIHRoZSBpdGVtIHRoYXQgaXMgdmlzaWJsZSxcbiAgICogcmF0aGVyIHRoYW4gdGhlIGZyYWN0aW9uIG9mIHRoZSB2aWV3YWJsZSBhcmVhIGl0IGNvdmVycy5cbiAgICovXG4gIGl0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZD86IG51bWJlcixcblxuICAvKipcbiAgICogTm90aGluZyBpcyBjb25zaWRlcmVkIHZpZXdhYmxlIHVudGlsIHRoZSB1c2VyIHNjcm9sbHMgb3IgYHJlY29yZEludGVyYWN0aW9uYCBpcyBjYWxsZWQgYWZ0ZXJcbiAgICogcmVuZGVyLlxuICAgKi9cbiAgd2FpdEZvckludGVyYWN0aW9uPzogYm9vbGVhbixcbnx9O1xuXG4vKipcbiAqIEEgVXRpbGl0eSBjbGFzcyBmb3IgY2FsY3VsYXRpbmcgdmlld2FibGUgaXRlbXMgYmFzZWQgb24gY3VycmVudCBtZXRyaWNzIGxpa2Ugc2Nyb2xsIHBvc2l0aW9uIGFuZFxuICogbGF5b3V0LlxuICpcbiAqIEFuIGl0ZW0gaXMgc2FpZCB0byBiZSBpbiBhIFwidmlld2FibGVcIiBzdGF0ZSB3aGVuIGFueSBvZiB0aGUgZm9sbG93aW5nXG4gKiBpcyB0cnVlIGZvciBsb25nZXIgdGhhbiBgbWluaW11bVZpZXdUaW1lYCBtaWxsaXNlY29uZHMgKGFmdGVyIGFuIGludGVyYWN0aW9uIGlmIGB3YWl0Rm9ySW50ZXJhY3Rpb25gXG4gKiBpcyB0cnVlKTpcbiAqXG4gKiAtIE9jY3VweWluZyA+PSBgdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGRgIG9mIHRoZSB2aWV3IGFyZWEgWE9SIGZyYWN0aW9uIG9mIHRoZSBpdGVtXG4gKiAgIHZpc2libGUgaW4gdGhlIHZpZXcgYXJlYSA+PSBgaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkYC5cbiAqIC0gRW50aXJlbHkgdmlzaWJsZSBvbiBzY3JlZW5cbiAqL1xuY2xhc3MgVmlld2FiaWxpdHlIZWxwZXIge1xuICBfY29uZmlnOiBWaWV3YWJpbGl0eUNvbmZpZztcbiAgX2hhc0ludGVyYWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgX3RpbWVyczogU2V0PG51bWJlcj4gPSBuZXcgU2V0KCk7XG4gIF92aWV3YWJsZUluZGljZXM6IEFycmF5PG51bWJlcj4gPSBbXTtcbiAgX3ZpZXdhYmxlSXRlbXM6IE1hcDxzdHJpbmcsIFZpZXdUb2tlbj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgY29uZmlnOiBWaWV3YWJpbGl0eUNvbmZpZyA9IHt2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZDogMH0sXG4gICkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwLCBlLmcuIG9uIHVubW91bnQuIENsZWFycyBhbnkgcGVuZGluZyB0aW1lcnMuXG4gICAqL1xuICBkaXNwb3NlKCkge1xuICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUbyBzZWVcbiAgICAgKiB0aGUgZXJyb3IgZGVsZXRlIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgdGhpcy5fdGltZXJzLmZvckVhY2goY2xlYXJUaW1lb3V0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHdoaWNoIGl0ZW1zIGFyZSB2aWV3YWJsZSBiYXNlZCBvbiB0aGUgY3VycmVudCBtZXRyaWNzIGFuZCBjb25maWcuXG4gICAqL1xuICBjb21wdXRlVmlld2FibGVJdGVtcyhcbiAgICBpdGVtQ291bnQ6IG51bWJlcixcbiAgICBzY3JvbGxPZmZzZXQ6IG51bWJlcixcbiAgICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuICAgIGdldEZyYW1lTWV0cmljczogKGluZGV4OiBudW1iZXIpID0+ID97XG4gICAgICBsZW5ndGg6IG51bWJlcixcbiAgICAgIG9mZnNldDogbnVtYmVyLFxuICAgICAgLi4uXG4gICAgfSxcbiAgICAvLyBPcHRpb25hbCBvcHRpbWl6YXRpb24gdG8gcmVkdWNlIHRoZSBzY2FuIHNpemVcbiAgICByZW5kZXJSYW5nZT86IHtcbiAgICAgIGZpcnN0OiBudW1iZXIsXG4gICAgICBsYXN0OiBudW1iZXIsXG4gICAgICAuLi5cbiAgICB9LFxuICApOiBBcnJheTxudW1iZXI+IHtcbiAgICBjb25zdCB7aXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkLCB2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZH0gPVxuICAgICAgdGhpcy5fY29uZmlnO1xuICAgIGNvbnN0IHZpZXdBcmVhTW9kZSA9IHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkICE9IG51bGw7XG4gICAgY29uc3Qgdmlld2FibGVQZXJjZW50VGhyZXNob2xkID0gdmlld0FyZWFNb2RlXG4gICAgICA/IHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkXG4gICAgICA6IGl0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZDtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQgIT0gbnVsbCAmJlxuICAgICAgICAoaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkICE9IG51bGwpICE9PVxuICAgICAgICAgICh2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCAhPSBudWxsKSxcbiAgICAgICdNdXN0IHNldCBleGFjdGx5IG9uZSBvZiBpdGVtVmlzaWJsZVBlcmNlbnRUaHJlc2hvbGQgb3Igdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGQnLFxuICAgICk7XG4gICAgY29uc3Qgdmlld2FibGVJbmRpY2VzID0gW107XG4gICAgaWYgKGl0ZW1Db3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHZpZXdhYmxlSW5kaWNlcztcbiAgICB9XG4gICAgbGV0IGZpcnN0VmlzaWJsZSA9IC0xO1xuICAgIGNvbnN0IHtmaXJzdCwgbGFzdH0gPSByZW5kZXJSYW5nZSB8fCB7Zmlyc3Q6IDAsIGxhc3Q6IGl0ZW1Db3VudCAtIDF9O1xuICAgIGlmIChsYXN0ID49IGl0ZW1Db3VudCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnSW52YWxpZCByZW5kZXIgcmFuZ2UgY29tcHV0aW5nIHZpZXdhYmlsaXR5ICcgK1xuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtyZW5kZXJSYW5nZSwgaXRlbUNvdW50fSksXG4gICAgICApO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBmb3IgKGxldCBpZHggPSBmaXJzdDsgaWR4IDw9IGxhc3Q7IGlkeCsrKSB7XG4gICAgICBjb25zdCBtZXRyaWNzID0gZ2V0RnJhbWVNZXRyaWNzKGlkeCk7XG4gICAgICBpZiAoIW1ldHJpY3MpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCB0b3AgPSBtZXRyaWNzLm9mZnNldCAtIHNjcm9sbE9mZnNldDtcbiAgICAgIGNvbnN0IGJvdHRvbSA9IHRvcCArIG1ldHJpY3MubGVuZ3RoO1xuICAgICAgaWYgKHRvcCA8IHZpZXdwb3J0SGVpZ2h0ICYmIGJvdHRvbSA+IDApIHtcbiAgICAgICAgZmlyc3RWaXNpYmxlID0gaWR4O1xuICAgICAgICBpZiAoXG4gICAgICAgICAgX2lzVmlld2FibGUoXG4gICAgICAgICAgICB2aWV3QXJlYU1vZGUsXG4gICAgICAgICAgICB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQsXG4gICAgICAgICAgICB0b3AsXG4gICAgICAgICAgICBib3R0b20sXG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodCxcbiAgICAgICAgICAgIG1ldHJpY3MubGVuZ3RoLFxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgdmlld2FibGVJbmRpY2VzLnB1c2goaWR4KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChmaXJzdFZpc2libGUgPj0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZpZXdhYmxlSW5kaWNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBGaWd1cmVzIG91dCB3aGljaCBpdGVtcyBhcmUgdmlld2FibGUgYW5kIGhvdyB0aGF0IGhhcyBjaGFuZ2VkIGZyb20gYmVmb3JlIGFuZCBjYWxsc1xuICAgKiBgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZGAgYXMgYXBwcm9wcmlhdGUuXG4gICAqL1xuICBvblVwZGF0ZShcbiAgICBpdGVtQ291bnQ6IG51bWJlcixcbiAgICBzY3JvbGxPZmZzZXQ6IG51bWJlcixcbiAgICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuICAgIGdldEZyYW1lTWV0cmljczogKGluZGV4OiBudW1iZXIpID0+ID97XG4gICAgICBsZW5ndGg6IG51bWJlcixcbiAgICAgIG9mZnNldDogbnVtYmVyLFxuICAgICAgLi4uXG4gICAgfSxcbiAgICBjcmVhdGVWaWV3VG9rZW46IChpbmRleDogbnVtYmVyLCBpc1ZpZXdhYmxlOiBib29sZWFuKSA9PiBWaWV3VG9rZW4sXG4gICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZDogKHtcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgLi4uXG4gICAgfSkgPT4gdm9pZCxcbiAgICAvLyBPcHRpb25hbCBvcHRpbWl6YXRpb24gdG8gcmVkdWNlIHRoZSBzY2FuIHNpemVcbiAgICByZW5kZXJSYW5nZT86IHtcbiAgICAgIGZpcnN0OiBudW1iZXIsXG4gICAgICBsYXN0OiBudW1iZXIsXG4gICAgICAuLi5cbiAgICB9LFxuICApOiB2b2lkIHtcbiAgICBpZiAoXG4gICAgICAodGhpcy5fY29uZmlnLndhaXRGb3JJbnRlcmFjdGlvbiAmJiAhdGhpcy5faGFzSW50ZXJhY3RlZCkgfHxcbiAgICAgIGl0ZW1Db3VudCA9PT0gMCB8fFxuICAgICAgIWdldEZyYW1lTWV0cmljcygwKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgdmlld2FibGVJbmRpY2VzID0gW107XG4gICAgaWYgKGl0ZW1Db3VudCkge1xuICAgICAgdmlld2FibGVJbmRpY2VzID0gdGhpcy5jb21wdXRlVmlld2FibGVJdGVtcyhcbiAgICAgICAgaXRlbUNvdW50LFxuICAgICAgICBzY3JvbGxPZmZzZXQsXG4gICAgICAgIHZpZXdwb3J0SGVpZ2h0LFxuICAgICAgICBnZXRGcmFtZU1ldHJpY3MsXG4gICAgICAgIHJlbmRlclJhbmdlLFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmxlbmd0aCA9PT0gdmlld2FibGVJbmRpY2VzLmxlbmd0aCAmJlxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmV2ZXJ5KCh2LCBpaSkgPT4gdiA9PT0gdmlld2FibGVJbmRpY2VzW2lpXSlcbiAgICApIHtcbiAgICAgIC8vIFdlIG1pZ2h0IGdldCBhIGxvdCBvZiBzY3JvbGwgZXZlbnRzIHdoZXJlIHZpc2liaWxpdHkgZG9lc24ndCBjaGFuZ2UgYW5kIHdlIGRvbid0IHdhbnQgdG8gZG9cbiAgICAgIC8vIGV4dHJhIHdvcmsgaW4gdGhvc2UgY2FzZXMuXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcyA9IHZpZXdhYmxlSW5kaWNlcztcbiAgICBpZiAodGhpcy5fY29uZmlnLm1pbmltdW1WaWV3VGltZSkge1xuICAgICAgY29uc3QgaGFuZGxlID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICAgKiBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjYzIHdhcyBkZXBsb3llZC4gVG9cbiAgICAgICAgICogc2VlIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgdGhpcy5fdGltZXJzLmRlbGV0ZShoYW5kbGUpO1xuICAgICAgICB0aGlzLl9vblVwZGF0ZVN5bmMoXG4gICAgICAgICAgdmlld2FibGVJbmRpY2VzLFxuICAgICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgICAgY3JlYXRlVmlld1Rva2VuLFxuICAgICAgICApO1xuICAgICAgfSwgdGhpcy5fY29uZmlnLm1pbmltdW1WaWV3VGltZSk7XG4gICAgICAvKiAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXSAoPj0wLjYzLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXNcbiAgICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUbyBzZWVcbiAgICAgICAqIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgIHRoaXMuX3RpbWVycy5hZGQoaGFuZGxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fb25VcGRhdGVTeW5jKFxuICAgICAgICB2aWV3YWJsZUluZGljZXMsXG4gICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgIGNyZWF0ZVZpZXdUb2tlbixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIGNsZWFuLXVwIGNhY2hlZCBfdmlld2FibGVJbmRpY2VzIHRvIGV2YWx1YXRlIGNoYW5nZWQgaXRlbXMgb24gbmV4dCB1cGRhdGVcbiAgICovXG4gIHJlc2V0Vmlld2FibGVJbmRpY2VzKCkge1xuICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZHMgdGhhdCBhbiBpbnRlcmFjdGlvbiBoYXMgaGFwcGVuZWQgZXZlbiBpZiB0aGVyZSBoYXMgYmVlbiBubyBzY3JvbGwuXG4gICAqL1xuICByZWNvcmRJbnRlcmFjdGlvbigpIHtcbiAgICB0aGlzLl9oYXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9vblVwZGF0ZVN5bmMoXG4gICAgdmlld2FibGVJbmRpY2VzVG9DaGVjazogQXJyYXk8bnVtYmVyPixcbiAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiAoe1xuICAgICAgY2hhbmdlZDogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICAuLi5cbiAgICB9KSA9PiB2b2lkLFxuICAgIGNyZWF0ZVZpZXdUb2tlbjogKGluZGV4OiBudW1iZXIsIGlzVmlld2FibGU6IGJvb2xlYW4pID0+IFZpZXdUb2tlbixcbiAgKSB7XG4gICAgLy8gRmlsdGVyIG91dCBpbmRpY2VzIHRoYXQgaGF2ZSBnb25lIG91dCBvZiB2aWV3IHNpbmNlIHRoaXMgY2FsbCB3YXMgc2NoZWR1bGVkLlxuICAgIHZpZXdhYmxlSW5kaWNlc1RvQ2hlY2sgPSB2aWV3YWJsZUluZGljZXNUb0NoZWNrLmZpbHRlcihpaSA9PlxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmluY2x1ZGVzKGlpKSxcbiAgICApO1xuICAgIGNvbnN0IHByZXZJdGVtcyA9IHRoaXMuX3ZpZXdhYmxlSXRlbXM7XG4gICAgY29uc3QgbmV4dEl0ZW1zID0gbmV3IE1hcChcbiAgICAgIHZpZXdhYmxlSW5kaWNlc1RvQ2hlY2subWFwKGlpID0+IHtcbiAgICAgICAgY29uc3Qgdmlld2FibGUgPSBjcmVhdGVWaWV3VG9rZW4oaWksIHRydWUpO1xuICAgICAgICByZXR1cm4gW3ZpZXdhYmxlLmtleSwgdmlld2FibGVdO1xuICAgICAgfSksXG4gICAgKTtcblxuICAgIGNvbnN0IGNoYW5nZWQgPSBbXTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZpZXdhYmxlXSBvZiBuZXh0SXRlbXMpIHtcbiAgICAgIGlmICghcHJldkl0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICAgIGNoYW5nZWQucHVzaCh2aWV3YWJsZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgW2tleSwgdmlld2FibGVdIG9mIHByZXZJdGVtcykge1xuICAgICAgaWYgKCFuZXh0SXRlbXMuaGFzKGtleSkpIHtcbiAgICAgICAgY2hhbmdlZC5wdXNoKHsuLi52aWV3YWJsZSwgaXNWaWV3YWJsZTogZmFsc2V9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNoYW5nZWQubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5fdmlld2FibGVJdGVtcyA9IG5leHRJdGVtcztcbiAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQoe1xuICAgICAgICB2aWV3YWJsZUl0ZW1zOiBBcnJheS5mcm9tKG5leHRJdGVtcy52YWx1ZXMoKSksXG4gICAgICAgIGNoYW5nZWQsXG4gICAgICAgIHZpZXdhYmlsaXR5Q29uZmlnOiB0aGlzLl9jb25maWcsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gX2lzVmlld2FibGUoXG4gIHZpZXdBcmVhTW9kZTogYm9vbGVhbixcbiAgdmlld2FibGVQZXJjZW50VGhyZXNob2xkOiBudW1iZXIsXG4gIHRvcDogbnVtYmVyLFxuICBib3R0b206IG51bWJlcixcbiAgdmlld3BvcnRIZWlnaHQ6IG51bWJlcixcbiAgaXRlbUxlbmd0aDogbnVtYmVyLFxuKTogYm9vbGVhbiB7XG4gIGlmIChfaXNFbnRpcmVseVZpc2libGUodG9wLCBib3R0b20sIHZpZXdwb3J0SGVpZ2h0KSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHBpeGVscyA9IF9nZXRQaXhlbHNWaXNpYmxlKHRvcCwgYm90dG9tLCB2aWV3cG9ydEhlaWdodCk7XG4gICAgY29uc3QgcGVyY2VudCA9XG4gICAgICAxMDAgKiAodmlld0FyZWFNb2RlID8gcGl4ZWxzIC8gdmlld3BvcnRIZWlnaHQgOiBwaXhlbHMgLyBpdGVtTGVuZ3RoKTtcbiAgICByZXR1cm4gcGVyY2VudCA+PSB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gX2dldFBpeGVsc1Zpc2libGUoXG4gIHRvcDogbnVtYmVyLFxuICBib3R0b206IG51bWJlcixcbiAgdmlld3BvcnRIZWlnaHQ6IG51bWJlcixcbik6IG51bWJlciB7XG4gIGNvbnN0IHZpc2libGVIZWlnaHQgPSBNYXRoLm1pbihib3R0b20sIHZpZXdwb3J0SGVpZ2h0KSAtIE1hdGgubWF4KHRvcCwgMCk7XG4gIHJldHVybiBNYXRoLm1heCgwLCB2aXNpYmxlSGVpZ2h0KTtcbn1cblxuZnVuY3Rpb24gX2lzRW50aXJlbHlWaXNpYmxlKFxuICB0b3A6IG51bWJlcixcbiAgYm90dG9tOiBudW1iZXIsXG4gIHZpZXdwb3J0SGVpZ2h0OiBudW1iZXIsXG4pOiBib29sZWFuIHtcbiAgcmV0dXJuIHRvcCA+PSAwICYmIGJvdHRvbSA8PSB2aWV3cG9ydEhlaWdodCAmJiBib3R0b20gPiB0b3A7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmlld2FiaWxpdHlIZWxwZXI7XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBQUM7QUFBQTtBQUFBO0FBQUE7QUFFYixJQUFNQSxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFBQyxJQThEakNDLGlCQUFpQjtFQU9yQiw2QkFFRTtJQUFBLElBREFDLE1BQXlCLHVFQUFHO01BQUNDLGdDQUFnQyxFQUFFO0lBQUMsQ0FBQztJQUFBO0lBQUEsS0FObkVDLGNBQWMsR0FBWSxLQUFLO0lBQUEsS0FDL0JDLE9BQU8sR0FBZ0IsSUFBSUMsR0FBRyxFQUFFO0lBQUEsS0FDaENDLGdCQUFnQixHQUFrQixFQUFFO0lBQUEsS0FDcENDLGNBQWMsR0FBMkIsSUFBSUMsR0FBRyxFQUFFO0lBS2hELElBQUksQ0FBQ0MsT0FBTyxHQUFHUixNQUFNO0VBQ3ZCO0VBQUM7SUFBQTtJQUFBLE9BS0QsbUJBQVU7TUFJUixJQUFJLENBQUNHLE9BQU8sQ0FBQ00sT0FBTyxDQUFDQyxZQUFZLENBQUM7SUFDcEM7RUFBQztJQUFBO0lBQUEsT0FLRCw4QkFDRUMsU0FBaUIsRUFDakJDLFlBQW9CLEVBQ3BCQyxjQUFzQixFQUN0QkMsZUFJQyxFQUVEQyxXQUlDLEVBQ2M7TUFDZixvQkFDRSxJQUFJLENBQUNQLE9BQU87UUFEUFEsMkJBQTJC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